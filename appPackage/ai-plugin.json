{
  "$schema": "https://developer.microsoft.com/json-schemas/copilot/plugin/v2.3/schema.json",
  "schema_version": "v2.3",
  "name_for_human": "Bloxs Real Estate",
  "description_for_human": "Query Bloxs real estate data: properties, tenants, contracts, maintenance and financials. Get portfolio insights, vacancy analysis, and KPIs.",
  "description_for_model": "Bloxs real estate data analyst. Query OData API (read-only) for portfolio insights, cross-entity analysis, and KPI calculations.\n\n## Response Modes\n- **Quick**: Single endpoint, direct facts\n- **Deep**: Multi-endpoint, calculated KPIs\n- **Research**: Full cross-entity analysis, recommendations\n\n## Key Patterns\n- Portfolio: getCommercialOverview (no joins needed)\n- Vacancy: getUnits(OccupationPercentage lt 1) + getTheoreticalRentItems for €-impact\n- Arrears: getOpenPositionDebtors(Age gt 30) for risk\n- Contracts: getSalesContracts(IsEnded eq false, EndDate lt X)\n- Costs: getPurchaseInvoices → getPurchaseInvoiceLines if RealEstateObjectName empty\n- Mortgages: getLedgerAccounts(contains Name 'hypothe') → getFinancialMutations\n\n## Rules\n- Labels (Status/State) are tenant-specific: discover via lookup endpoints first\n- FinancialMutations: ALWAYS $filter + $top<=100\n- Use $select for efficiency, $top=50 default",
  "namespace": "bloxs",
  "logo_url": "https://www.bloxs.com/wp-content/uploads/2024/06/logo.png",
  "legal_info_url": "https://www.bloxs.com/privacyverklaring/",
  "privacy_policy_url": "https://www.bloxs.com/privacyverklaring/",
  "functions": [
    {
      "name": "getUnits",
      "description": "Core property entity. For vacancy: $filter=OccupationPercentage lt 1 and not contains(DisplayName,'VERKOCHT'), verify ActiveContractRentId is null. Exclude units with FinancialMutations on parent (externally managed). Combine with getTheoreticalRentItems for €-impact. Key: UnitId, DisplayAddress, OwnerId, OccupationPercentage, ComplexId.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getBuildings",
      "description": "Get standalone buildings. Filter by OwnerId for owner-specific properties. Use DisplayAddress for location.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getComplexes",
      "description": "Get complexes (multi-unit properties). Check OccupationPercentage for vacancy rate.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getCommercialOverview",
      "description": "BEST for portfolio dashboard - no joins needed. Contains Address, OwnerName, TenantName, IsOccupied, BareRent_Yearly_TotalAmountExcl, ContractStartDate, ContractEndDate. Calculate: total rent, occupancy rate, contract expiry risk.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getCommercialOverviewSpecific",
      "description": "Extended commercial overview with EnergyLabel, TheoreticalRent, FutureContractStartDate for deeper analysis.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getRealEstateObjects",
      "description": "Base table for all property types. Use specific tables (Units, Buildings) when OwnerId filtering is needed.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSections",
      "description": "Get sections within complexes for hierarchical portfolio views.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getAddresses",
      "description": "Get address records with Street, City, PostalCode, Latitude, Longitude for geodata.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getOwners",
      "description": "Get property owners with DisplayName, Email, RelationId for linking to other entities.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getPersons",
      "description": "Get persons (tenants, contacts) with RelationId to link to contracts.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getRelations",
      "description": "Base table for all relation types (persons, organisations, suppliers).",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSalesContracts",
      "description": "CONTRACT MANAGEMENT: Rent contracts. Filter IsEnded eq false for active. For expiry risk: EndDate lt [date]. Key: SalesContractId, Reference, RelationName, OwnerName, StartDate, EndDate, IsEnded. Combine with getSalesContractLineItems for rent amounts per property.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSalesContractRealestateObjects",
      "description": "Link table: SalesContractId to RealEstateObjectId. Use for contract-to-property joins.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSalesContractLineItems",
      "description": "Rent line items with RealEstateObjectName, Amount, StartDate, EndDate. Good for rent-per-property analysis.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSalesContractLines",
      "description": "Contract lines by RealEstateObjectId. Best source for contract history: query by RealEstateObjectId, collect SalesContractId values, then fetch SalesContracts.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getServiceTickets",
      "description": "MAINTENANCE ANALYSIS: Service tickets - NO JOINS needed. Contains RealEstateObjectName, TenantName, SupplierName, ServiceTicketStateName. For open tickets: first getServiceTicketStates to discover state names. Combine with getPurchaseInvoices for cost analysis.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getServiceTicketStates",
      "description": "Valid ticket states (tenant-specific). Query first to discover state names before filtering ServiceTickets.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getServiceTicketProblemCategories",
      "description": "Ticket problem categories (tenant-specific). Discover valid labels before filtering tickets.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getServiceTicketCostCategories",
      "description": "Ticket cost categories for maintenance cost classification.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getFinancialMutations",
      "description": "FINANCIAL DEEP-DIVE: Ledger transactions. **ALWAYS** $filter + $top<=100. For mortgages: first getLedgerAccounts(contains Name 'hypothe'), then filter by LedgerAccountCode. Key: TransactionDate, LedgerAccountCode, Amount, RealEstateObjectName, RelationName. Calculate: mortgage payments, interest costs.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getLedgerAccounts",
      "description": "Chart of accounts. Use contains(Name,'hypothe') to find mortgage account codes for FinancialMutations.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSalesInvoices",
      "description": "Sales invoices to tenants. Filter by FinancialYear. WorkflowState is tenant-specific.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getSalesInvoiceLines",
      "description": "Invoice lines with RealEstateObjectId for property-level allocation. Filter by SalesInvoiceId.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getPurchaseInvoices",
      "description": "COST ANALYSIS: Purchase invoices from suppliers. Filter FinancialYear eq 2025. Key: PurchaseInvoiceId, Reference, InvoiceDate, TotalValueIncluding, RelationName, RealEstateObjectName. If RealEstateObjectName empty: use getPurchaseInvoiceLines. Calculate: costs per property, cost/m².",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getPurchaseInvoiceLines",
      "description": "Invoice lines with RealEstateObjectId. Use when header lacks property info; filter by PurchaseInvoiceId.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getOpenPositionDebtors",
      "description": "RISK ANALYSIS: Outstanding receivables. Filter Age gt 30 for overdue payments. Key: RelationName, OutstandingAmount, Age, DueDate, OwnerName. Calculate: total arrears, DSO, tenant risk score. Combine with getSalesContracts for tenant context.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getOpenPositionCreditors",
      "description": "Creditor aging with outstanding amounts to suppliers.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getFinancingContracts",
      "description": "Financing contracts (loans/mortgages). Often empty; prefer LedgerAccounts + FinancialMutations for mortgage data.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getPropertyValuationValues",
      "description": "VALUATION DATA: WOZ values per property. Filter ValuationYear eq 2025/2026. Key: RealEstateObjectId, RealEstateObjectName, Value, ValuationYear. Combine with getUnits(OwnerId) for owner-specific WOZ. Calculate: total portfolio value, LTV ratio.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getTheoreticalRentItems",
      "description": "VACANCY COST ANALYSIS: Market rent per property. Combine with getUnits(vacant) to calculate €-impact of vacancy. Key: RealEstateObjectId, RealEstateObjectName, Amount. Sum Amount for total potential rent loss.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getInstallations",
      "description": "Equipment with NextMaintenanceOn for maintenance planning.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getMeters",
      "description": "Utility meters (electricity, gas, water) per property.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getMeterReadings",
      "description": "Meter reading values over time. Link via MeterId.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getTasks",
      "description": "System tasks and reminders with Deadline, Status fields.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getNotes",
      "description": "Notes attached to entities. Filter by EntityLinkType (Unit=13, Building=11, Complex=12, Person=4, Owner=1, ServiceTicket=63) and EntityId.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    },
    {
      "name": "getOwnerSettlements",
      "description": "Owner settlements per period with TotalSettlementBalance.",
      "capabilities": {
        "security_info": { "data_handling": ["GetPrivateData"] }
      }
    }
  ],
  "runtimes": [
    {
      "type": "OpenApi",
      "auth": {
        "type": "ApiKeyPluginVault",
        "reference_id": "${{BLOXS_API_KEY_REFERENCE}}"
      },
      "spec": {
        "url": "bloxs-openapi.yaml"
      },
      "run_for_functions": ["*"]
    }
  ],
  "capabilities": {
    "conversation_starters": [
      { "text": "Show me an overview of our real estate portfolio" },
      { "text": "Find all open maintenance tickets" },
      { "text": "List all vacant rental units" },
      { "text": "Show contracts expiring soon" },
      { "text": "What are the WOZ values of our properties?" }
    ]
  }
}
